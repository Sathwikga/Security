 Install netcat in CentOS
 
 yum install nc.x86_64
 


Intrusion Detection System
==========================
log file location.
$ cd /var/log/

$ cd /etc
$ less rsyslog.conf

$ grep rsyslog.d rsyslog.conf

$ cd /etc/rsyslog.d/
$ ls

$ cd /var/log
$ sudo less syslog

$ cat kern.log 
$ cat auth.log 

# cd /etc/audit

# apt-cache search auditd
# vi audit.rules

-b 4096 


-w /etc/shadow -p wa -k usermods
-a always,exit -S clock_settime -k timechange

# service auditd start

# ls /var/log/audit 
audit.log 


Cryptographic Hash
==================
# touch sample.data
# echo "Thsi is test" > sample.data
# md5sum sample.data


Hash Collision
---------------
- Get same hash value of the two different content


TripWire is the Host-Based IDS
------------------------------
- uses cryptographic hashes 
# apt-get install tripwire

After installation 
# cd /etc/tripwire
# less twcfg.txt
# less twpol.txt

Lets create a configuration file
# ls
# twadmin --create-cfgfile --cfgfile tw.cfg.enc --site-keyfile site.key twcfg.txt

Create a policy file
# twadmin --create-polfile --cfgfile tw.cfg.enc --polfile tw.pol.enc --site-keyfile site.key twpol.txt

Initialize the database
# tripwire --init --cfgfile tw.cfg.enc --polfile tw.pol.enc --site-keyfile site.key --local-keyfile comp7327-local.key

Look at the policy file and generate a database file
/var/lib/tripwire


Check all of our file against database

# tripwire --check 

Update the database if you change one of these ciritical files. 

OSSEC (https://ossec.github.io/)
---------------------------------
- rootkit checking 
- process monitoring 

Download (https://ossec.github.io/downloads.html)

Download the source and build and install.

Server runs on UNIX and agent can run on Windows.

Installation
------------
# tar xvf ossec-hids-2.9.3.tar.gz
# cd ossec-hids-2.9.3
# less INSTALL
# ./install.sh

# /etc/init.d/ossec start


Install agent to talk to server
-------------------------------
# cd /var/ossec/bin
# ./manage_agents

Text based menu 

We need to get the 

Got to windows and install agent 
paste the key 

# cd /var/ossec/logs/alerts
# cat alerts.log


# apt-cache search samhain 

- Date integrity and host intrusion alert system
Install
# apt-get install samhain

# cd /etc/samhain
# vi samhainrc

